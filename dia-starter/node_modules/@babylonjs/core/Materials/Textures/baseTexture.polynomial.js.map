{"version":3,"file":"baseTexture.polynomial.js","sourceRoot":"","sources":["../../../../../dev/core/src/Materials/Textures/baseTexture.polynomial.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,iCAAiC,EAAE,MAAM,0DAA0D,CAAC;AAE7G,OAAO,EAAE,WAAW,EAAE,MAAM,eAAe,CAAC;AAmB5C,WAAW,CAAC,SAAS,CAAC,kCAAkC,GAAG;IACvD,IAAI,IAAI,CAAC,QAAQ,EAAE;QACf,IAAI,CAAC,QAAQ,CAAC,oBAAoB,GAAG,IAAI,CAAC;QAC1C,IAAI,CAAC,QAAQ,CAAC,2BAA2B,GAAG,IAAI,CAAC;QACjD,IAAI,CAAC,QAAQ,CAAC,4BAA4B,GAAG,KAAK,CAAC;KACtD;AACL,CAAC,CAAC;AAEF,MAAM,CAAC,cAAc,CAAC,WAAW,CAAC,SAAS,EAAE,qBAAqB,EAAE;IAChE,GAAG,EAAE;QACD,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,IAAI,IAAI,CAAC,QAAQ,CAAC,oBAAoB,IAAI,IAAI,CAAC,QAAQ,CAAC,4BAA4B,EAAE;gBAClF,OAAO,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC;aAC7C;YAED,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE;gBACvB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,2BAA2B,EAAE;oBAC5C,IAAI,CAAC,QAAQ,CAAC,2BAA2B,GAAG,iCAAiC,CAAC,0CAA0C,CAAC,IAAI,CAAC,CAAC;oBAC/H,IAAI,IAAI,CAAC,QAAQ,CAAC,2BAA2B,KAAK,IAAI,EAAE;wBACpD,IAAI,CAAC,QAAQ,CAAC,4BAA4B,GAAG,IAAI,CAAC;qBACrD;yBAAM;wBACH,IAAI,CAAC,QAAQ,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC,mBAAmB,EAAE,EAAE;4BACnE,IAAI,CAAC,QAAS,CAAC,oBAAoB,GAAG,mBAAmB,CAAC;4BAC1D,IAAI,CAAC,QAAS,CAAC,4BAA4B,GAAG,IAAI,CAAC;wBACvD,CAAC,CAAC,CAAC;qBACN;iBACJ;gBAED,OAAO,IAAI,CAAC;aACf;SACJ;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IACD,GAAG,EAAE,UAA6B,KAAoC;QAClE,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,IAAI,CAAC,QAAQ,CAAC,oBAAoB,GAAG,KAAK,CAAC;SAC9C;IACL,CAAC;IACD,UAAU,EAAE,IAAI;IAChB,YAAY,EAAE,IAAI;CACrB,CAAC,CAAC","sourcesContent":["import type { Nullable } from \"../../types\";\r\nimport { CubeMapToSphericalPolynomialTools } from \"../../Misc/HighDynamicRange/cubemapToSphericalPolynomial\";\r\nimport type { SphericalPolynomial } from \"../../Maths/sphericalPolynomial\";\r\nimport { BaseTexture } from \"./baseTexture\";\r\n\r\ndeclare module \"./baseTexture\" {\r\n    export interface BaseTexture {\r\n        /**\r\n         * Get the polynomial representation of the texture data.\r\n         * This is mainly use as a fast way to recover IBL Diffuse irradiance data.\r\n         * @see https://learnopengl.com/PBR/IBL/Diffuse-irradiance\r\n         */\r\n        sphericalPolynomial: Nullable<SphericalPolynomial>;\r\n\r\n        /**\r\n         * Force recomputation of spherical polynomials.\r\n         * Can be useful if you generate a cubemap multiple times (from a probe for eg) and you need the proper polynomials each time\r\n         */\r\n        forceSphericalPolynomialsRecompute(): void;\r\n    }\r\n}\r\n\r\nBaseTexture.prototype.forceSphericalPolynomialsRecompute = function (): void {\r\n    if (this._texture) {\r\n        this._texture._sphericalPolynomial = null;\r\n        this._texture._sphericalPolynomialPromise = null;\r\n        this._texture._sphericalPolynomialComputed = false;\r\n    }\r\n};\r\n\r\nObject.defineProperty(BaseTexture.prototype, \"sphericalPolynomial\", {\r\n    get: function (this: BaseTexture) {\r\n        if (this._texture) {\r\n            if (this._texture._sphericalPolynomial || this._texture._sphericalPolynomialComputed) {\r\n                return this._texture._sphericalPolynomial;\r\n            }\r\n\r\n            if (this._texture.isReady) {\r\n                if (!this._texture._sphericalPolynomialPromise) {\r\n                    this._texture._sphericalPolynomialPromise = CubeMapToSphericalPolynomialTools.ConvertCubeMapTextureToSphericalPolynomial(this);\r\n                    if (this._texture._sphericalPolynomialPromise === null) {\r\n                        this._texture._sphericalPolynomialComputed = true;\r\n                    } else {\r\n                        this._texture._sphericalPolynomialPromise.then((sphericalPolynomial) => {\r\n                            this._texture!._sphericalPolynomial = sphericalPolynomial;\r\n                            this._texture!._sphericalPolynomialComputed = true;\r\n                        });\r\n                    }\r\n                }\r\n\r\n                return null;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    set: function (this: BaseTexture, value: Nullable<SphericalPolynomial>) {\r\n        if (this._texture) {\r\n            this._texture._sphericalPolynomial = value;\r\n        }\r\n    },\r\n    enumerable: true,\r\n    configurable: true,\r\n});\r\n"]}